<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ë¼ì¥í„° ì…ì°°ê³µê³  ê²€ìƒ‰</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="ë‚˜ë¼ì¥í„° ì…ì°°ê³µê³  ê²€ìƒ‰ ì‹œìŠ¤í…œ - ê³µê³µë°ì´í„°í¬í„¸ APIë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ì…ì°°ì •ë³´ ì¡°íšŒ">
    <meta name="keywords" content="ë‚˜ë¼ì¥í„°, ì…ì°°ê³µê³ , ê³µê³µë°ì´í„°, G2B, ì •ë¶€ì¡°ë‹¬">
    <meta name="author" content="PublicPortal">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="ë‚˜ë¼ì¥í„° ì…ì°°ê³µê³  ê²€ìƒ‰">
    <meta property="og:description" content="ì‹¤ì‹œê°„ ë‚˜ë¼ì¥í„° ì…ì°°ê³µê³  ê²€ìƒ‰ ë° Excel ë‚´ë³´ë‚´ê¸°">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cjlee-cmd.github.io/publicportal/">
    
    <!-- CSS Framework -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* Custom CSS for GitHub Pages */
        * {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        /* í¼ ìš”ì†Œ ìŠ¤íƒ€ì¼ë§ */
        input[type="date"], 
        input[type="text"], 
        select {
            transition: all 0.2s ease-in-out;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        }

        input[type="date"]:focus, 
        input[type="text"]:focus, 
        select:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ë§ */
        button {
            transition: all 0.2s ease-in-out;
        }

        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        button:active {
            transform: translateY(0);
        }

        /* í…Œì´ë¸” í–‰ í˜¸ë²„ íš¨ê³¼ */
        tbody tr:hover {
            background-color: #f8fafc;
            transform: scale(1.002);
            transition: all 0.2s ease-in-out;
        }

        /* ì„ íƒëœ í–‰ ìŠ¤íƒ€ì¼ */
        tbody tr.selected {
            background-color: #eff6ff;
            border-left: 4px solid #3b82f6;
        }

        /* ì…ì°° êµ¬ë¶„ ë±ƒì§€ */
        .badge-servc {
            background-color: #dbeafe;
            color: #1e40af;
        }

        .badge-cnstwk {
            background-color: #dcfce7;
            color: #166534;
        }

        .badge-thng {
            background-color: #fef3c7;
            color: #92400e;
        }

        /* ìƒíƒœ ì¸ë””ì¼€ì´í„° */
        .status-active {
            position: relative;
        }

        .status-active::before {
            content: '';
            position: absolute;
            left: -12px;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 8px;
            background-color: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        /* ë°˜ì‘í˜• ê·¸ë¦¬ë“œ */
        @media (max-width: 768px) {
            .grid-responsive {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 0.875rem;
            }
            
            .px-6 {
                padding-left: 1rem;
                padding-right: 1rem;
            }
        }

        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading-dots::after {
            content: '';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 20% {
                content: '';
            }
            40% {
                content: '.';
            }
            60% {
                content: '..';
            }
            80%, 100% {
                content: '...';
            }
        }

        /* ì„±ê³µ/ì—ëŸ¬ ë©”ì‹œì§€ */
        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            animation: fadeInUp 0.3s ease-in-out;
        }

        .alert-success {
            background-color: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }

        .alert-error {
            background-color: #fee2e2;
            color: #991b1b;
            border-left: 4px solid #ef4444;
        }

        .alert-warning {
            background-color: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }

        /* ì²´í¬ë°•ìŠ¤ ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ */
        input[type="checkbox"] {
            appearance: none;
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid #d1d5db;
            border-radius: 0.25rem;
            background-color: white;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease-in-out;
        }

        input[type="checkbox"]:checked {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }

        input[type="checkbox"]:checked::before {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 0.875rem;
        }

        /* GitHub Pages íŠ¹í™” ìŠ¤íƒ€ì¼ */
        .github-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        /* CORS ì—ëŸ¬ ì•Œë¦¼ ìŠ¤íƒ€ì¼ */
        .cors-notice {
            background: linear-gradient(135deg, #fef3c7, #fed7aa);
            border: 1px solid #f59e0b;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- GitHub Badge -->
    <a href="https://github.com/cjLee-cmd/publicportal" target="_blank" 
       class="github-badge bg-gray-900 text-white px-4 py-2 rounded-lg text-sm hover:bg-gray-800 transition-colors">
        <i class="fab fa-github mr-2"></i>
        GitHub
    </a>

    <!-- Header -->
    <header class="bg-white shadow-lg border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-3">
                    <div class="bg-blue-600 p-2 rounded-lg">
                        <i class="fas fa-search text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">ë‚˜ë¼ì¥í„° ì…ì°°ê³µê³  ê²€ìƒ‰</h1>
                        <p class="text-sm text-gray-500">Government e-Procurement Service</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2 text-sm text-gray-500">
                    <i class="fas fa-clock"></i>
                    <span id="currentTime"></span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- CORS Notice -->
        <div class="cors-notice">
            <div class="flex items-start space-x-3">
                <i class="fas fa-info-circle text-yellow-600 mt-1"></i>
                <div>
                    <h3 class="font-semibold text-yellow-800">ì•ˆë‚´ì‚¬í•­</h3>
                    <p class="text-sm text-yellow-700 mt-1">
                        ì´ ì›¹ì‚¬ì´íŠ¸ëŠ” GitHub Pagesì—ì„œ í˜¸ìŠ¤íŒ…ë˜ë©°, CORS ì •ì±…ìœ¼ë¡œ ì¸í•´ ì§ì ‘ API í˜¸ì¶œì— ì œí•œì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                        ì™„ì „í•œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ <a href="https://github.com/cjLee-cmd/publicportal" class="underline font-medium">GitHub ì €ì¥ì†Œ</a>ì—ì„œ ë¡œì»¬ë¡œ ì‹¤í–‰í•´ì£¼ì„¸ìš”.
                    </p>
                </div>
            </div>
        </div>

        <!-- Search Form -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-8">
            <h2 class="text-lg font-semibold text-gray-900 mb-6 flex items-center">
                <i class="fas fa-filter mr-2 text-blue-600"></i>
                ê²€ìƒ‰ ì¡°ê±´
            </h2>
            
            <form id="searchForm" class="space-y-6">
                <!-- ë‚ ì§œ êµ¬ê°„ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ì‹œì‘ì¼</label>
                        <input type="date" id="startDate" 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ì¢…ë£Œì¼</label>
                        <input type="date" id="endDate" 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
                
                <!-- ì…ì°° êµ¬ë¶„ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ì…ì°° êµ¬ë¶„</label>
                    <select id="bidType" 
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="all">ì „ì²´</option>
                        <option value="servc">ìš©ì—­</option>
                        <option value="cnstwk">ê±´ì„¤ê³µì‚¬</option>
                        <option value="thng">ë¬¼í’ˆ</option>
                    </select>
                </div>
                
                <!-- ê¸°ê´€ ì„ íƒ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ë°œì£¼ê¸°ê´€</label>
                    <select id="agencyFilter" 
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="all">ì „ì²´</option>
                        <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                    </select>
                </div>
                
                <!-- ê²€ìƒ‰ ë²„íŠ¼ -->
                <div class="flex justify-center">
                    <button type="submit" id="searchBtn"
                            class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-lg transition duration-200 flex items-center space-x-2">
                        <i class="fas fa-search"></i>
                        <span>ê²€ìƒ‰í•˜ê¸°</span>
                    </button>
                </div>
            </form>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="bg-white rounded-2xl shadow-sm border border-gray-200 hidden">
            <!-- Results Header -->
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <h3 class="text-lg font-semibold text-gray-900">ê²€ìƒ‰ ê²°ê³¼</h3>
                        <span id="resultCount" class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium"></span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button id="selectAllBtn" 
                                class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm transition duration-200">
                            <i class="fas fa-check-square mr-1"></i>
                            ì „ì²´ì„ íƒ
                        </button>
                        <button id="deleteSelectedBtn" 
                                class="bg-red-100 hover:bg-red-200 text-red-700 px-4 py-2 rounded-lg text-sm transition duration-200">
                            <i class="fas fa-trash mr-1"></i>
                            ì„ íƒì‚­ì œ
                        </button>
                        <button id="exportExcelBtn" 
                                class="bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-lg text-sm transition duration-200">
                            <i class="fas fa-file-excel mr-1"></i>
                            Excel ì €ì¥
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Table -->
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12">
                                <input type="checkbox" id="headerCheckbox" 
                                       class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">êµ¬ë¶„</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ê³µê³ ì¼</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ê³µê³ ëª…</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë°œì£¼ê¸°ê´€</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë§ˆê°ì¼</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì˜ˆì •ê°€ê²©</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë§í¬</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTableBody" class="bg-white divide-y divide-gray-200">
                        <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-lg shadow-lg flex items-center space-x-3">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                <span class="text-gray-700 font-medium loading-dots">ê²€ìƒ‰ ì¤‘</span>
            </div>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden text-center py-12">
            <div class="mx-auto h-24 w-24 text-gray-400">
                <i class="fas fa-search text-6xl"></i>
            </div>
            <h3 class="mt-4 text-lg font-medium text-gray-900">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
            <p class="mt-2 text-gray-500">ë‹¤ë¥¸ ì¡°ê±´ìœ¼ë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”.</p>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center text-gray-500 text-sm space-y-2">
                <p>&copy; 2025 ë‚˜ë¼ì¥í„° ì…ì°°ê³µê³  ê²€ìƒ‰ ì‹œìŠ¤í…œ. ê³µê³µë°ì´í„°í¬í„¸ API í™œìš©.</p>
                <p>
                    <a href="https://github.com/cjLee-cmd/publicportal" class="text-blue-600 hover:text-blue-800 underline">
                        <i class="fab fa-github mr-1"></i>GitHub ì €ì¥ì†Œ
                    </a>
                    ì—ì„œ ì „ì²´ ê¸°ëŠ¥ì„ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
            </div>
        </div>
    </footer>

    <!-- JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.24.0/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        // GitHub Pagesìš© í´ë¼ì´ì–¸íŠ¸ì‚¬ì´ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜
        class PublicPortalApp {
            constructor() {
                this.selectedItems = new Set();
                this.allData = [];
                this.apiKey = 'xXw4gHFIYeAF02lry3V2aAO+cBMUlGCCuEE4k5OMX4qAycWqmL4EfrzLl+akDZM85sDGNhI4kcks3ioy+qY/pA==';
                this.baseUrl = 'https://apis.data.go.kr/1230000/ad/BidPublicInfoService';
                // CORS í”„ë¡ì‹œ ëª©ë¡ (fallbackìš©)
                this.proxyUrls = [
                    'https://api.allorigins.win/get?url=', // JSON ì‘ë‹µìœ¼ë¡œ ë³€ê²½
                    'https://api.codetabs.com/v1/proxy?quest=',
                    'https://cors-anywhere.herokuapp.com/'
                ];
                this.currentProxyIndex = 0;
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.setDefaultDates();
                this.updateCurrentTime();
                this.loadAgencies();
                
                // ì‹œê°„ ì—…ë°ì´íŠ¸ (1ë¶„ë§ˆë‹¤)
                setInterval(() => this.updateCurrentTime(), 60000);
            }

            setupEventListeners() {
                // ê²€ìƒ‰ í¼
                document.getElementById('searchForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.performSearch();
                });

                // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤
                document.getElementById('headerCheckbox').addEventListener('change', (e) => {
                    this.toggleSelectAll(e.target.checked);
                });

                // ë²„íŠ¼ ì´ë²¤íŠ¸
                document.getElementById('selectAllBtn').addEventListener('click', () => {
                    this.selectAll();
                });

                document.getElementById('deleteSelectedBtn').addEventListener('click', () => {
                    this.deleteSelected();
                });

                document.getElementById('exportExcelBtn').addEventListener('click', () => {
                    this.exportToExcel();
                });
            }

            updateCurrentTime() {
                const now = new Date();
                const timeString = now.toLocaleString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: false
                });
                document.getElementById('currentTime').textContent = timeString;
            }

            setDefaultDates() {
                const today = new Date();
                const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
                
                document.getElementById('startDate').value = this.formatDate(weekAgo);
                document.getElementById('endDate').value = this.formatDate(today);
            }

            formatDate(date) {
                return date.toISOString().split('T')[0];
            }

            async loadAgencies() {
                // ìƒ˜í”Œ ê¸°ê´€ ëª©ë¡ (ì‹¤ì œë¡œëŠ” APIì—ì„œ ë™ì ìœ¼ë¡œ ë¡œë“œí•´ì•¼ í•¨)
                const agencies = [
                    'í•œêµ­ì „ë ¥ê³µì‚¬',
                    'í•œêµ­í† ì§€ì£¼íƒê³µì‚¬',
                    'í•œêµ­ë„ë¡œê³µì‚¬',
                    'í•œêµ­ì² ë„ê³µì‚¬',
                    'êµìœ¡ë¶€',
                    'êµ­í† êµí†µë¶€',
                    'ë³´ê±´ë³µì§€ë¶€',
                    'ê³¼í•™ê¸°ìˆ ì •ë³´í†µì‹ ë¶€',
                    'í™˜ê²½ë¶€',
                    'êµ­ë°©ë¶€'
                ];

                const select = document.getElementById('agencyFilter');
                select.innerHTML = '<option value="all">ì „ì²´</option>';
                
                agencies.forEach(agency => {
                    const option = document.createElement('option');
                    option.value = agency;
                    option.textContent = agency;
                    select.appendChild(option);
                });
            }

            async performSearch() {
                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;
                const bidType = document.getElementById('bidType').value;
                const agencyFilter = document.getElementById('agencyFilter').value;

                this.showLoading(true);
                this.hideResults();

                try {
                    // ë‚ ì§œ í¬ë§·íŒ…
                    const startDt = startDate ? startDate.replace(/-/g, '') + '0000' : '';
                    const endDt = endDate ? endDate.replace(/-/g, '') + '2359' : '';

                    const types = bidType === 'all' ? ['servc', 'cnstwk', 'thng'] : [bidType];
                    this.allData = [];

                    for (const type of types) {
                        try {
                            const data = await this.fetchBidData(type, startDt, endDt);
                            if (data && data.length > 0) {
                                // ê¸°ê´€ í•„í„°ë§
                                const filteredData = agencyFilter === 'all' ? 
                                    data : data.filter(item => item.dminsttNm && item.dminsttNm.includes(agencyFilter));
                                
                                this.allData = this.allData.concat(filteredData);
                            }
                        } catch (error) {
                            console.warn(`${type} ì¡°íšŒ ì‹¤íŒ¨:`, error);
                        }
                    }

                    if (this.allData.length > 0) {
                        // ë‚ ì§œìˆœ ì •ë ¬ (ìµœì‹ ìˆœ)
                        this.allData.sort((a, b) => (b.bidNtceDt || '').localeCompare(a.bidNtceDt || ''));
                        this.displayResults(this.allData);
                        this.showSuccessMessage(`${this.allData.length}ê°œì˜ ì…ì°°ê³µê³ ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.`);
                    } else {
                        this.showEmptyState();
                        this.showWarningMessage(`
                            <div class="text-center">
                                <div class="text-lg font-semibold mb-2">âš ï¸ ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                                <div class="text-sm text-gray-600 mb-4">
                                    ëª¨ë“  CORS í”„ë¡ì‹œì—ì„œ API í˜¸ì¶œì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.<br>
                                    í˜„ì¬ ìƒ˜í”Œ ë°ì´í„°ë¥¼ í‘œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤.
                                </div>
                                <div class="text-xs text-gray-500 bg-gray-50 p-3 rounded-lg">
                                    <strong>ğŸ’¡ ì™„ì „í•œ ê¸°ëŠ¥ì„ ìœ„í•´:</strong><br>
                                    â€¢ ë¡œì»¬ í™˜ê²½ì—ì„œ ì‹¤í–‰: <code>python3 run_web.py</code><br>
                                    â€¢ GitHub: <a href="https://github.com/cjLee-cmd/publicportal" class="text-blue-600 underline" target="_blank">ì†ŒìŠ¤ ì½”ë“œ ë‹¤ìš´ë¡œë“œ</a>
                                </div>
                            </div>
                        `);
                    }

                } catch (error) {
                    console.error('ê²€ìƒ‰ ì‹¤íŒ¨:', error);
                    this.showErrorMessage(`
                        <div class="text-center">
                            <div class="text-lg font-semibold mb-2">âŒ API í˜¸ì¶œ ì‹¤íŒ¨</div>
                            <div class="text-sm text-gray-600 mb-4">
                                GitHub Pages í™˜ê²½ì—ì„œëŠ” CORS ì •ì±…ìœ¼ë¡œ ì¸í•´<br>
                                ì‹¤ì‹œê°„ API í˜¸ì¶œì´ ì œí•œë©ë‹ˆë‹¤.
                            </div>
                            <div class="text-xs text-gray-500 bg-gray-50 p-3 rounded-lg">
                                <strong>ğŸš€ í•´ê²° ë°©ë²•:</strong><br>
                                1. ë¡œì»¬ í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ê¸°<br>
                                2. <a href="https://github.com/cjLee-cmd/publicportal" class="text-blue-600 underline" target="_blank">GitHub ì €ì¥ì†Œ</a>ì—ì„œ ì½”ë“œ ë‹¤ìš´ë¡œë“œ<br>
                                3. <code>python3 run_web.py</code> ì‹¤í–‰
                            </div>
                        </div>
                    `);
                    this.showEmptyState();
                } finally {
                    this.showLoading(false);
                }
            }

            async fetchBidData(bidType, startDt, endDt) {
                const endpoints = {
                    'servc': 'getBidPblancListInfoServc',
                    'cnstwk': 'getBidPblancListInfoCnstwk', 
                    'thng': 'getBidPblancListInfoThng'
                };

                const endpoint = endpoints[bidType];
                const encodedKey = encodeURIComponent(this.apiKey);
                
                const url = `${this.baseUrl}/${endpoint}?serviceKey=${encodedKey}&pageNo=1&numOfRows=100&inqryDiv=1&inqryBgnDt=${startDt}&inqryEndDt=${endDt}`;
                
                // ì—¬ëŸ¬ CORS í”„ë¡ì‹œ ì‹œë„
                for (let i = 0; i < this.proxyUrls.length; i++) {
                    const proxyUrl = this.proxyUrls[i];
                    
                    try {
                        console.log(`${bidType} ì¡°íšŒ ì‹œë„ (í”„ë¡ì‹œ ${i+1}/${this.proxyUrls.length}): ${proxyUrl.split('//')[1].split('/')[0]}`);
                        
                        let response, xmlText;
                        
                        if (proxyUrl.includes('allorigins.win/get')) {
                            // allorigins JSON ì‘ë‹µ ì²˜ë¦¬
                            response = await fetch(`${proxyUrl}${encodeURIComponent(url)}`);
                            const jsonData = await response.json();
                            xmlText = jsonData.contents;
                        } else {
                            // ì§ì ‘ í…ìŠ¤íŠ¸ ì‘ë‹µ ì²˜ë¦¬
                            response = await fetch(`${proxyUrl}${encodeURIComponent(url)}`);
                            xmlText = await response.text();
                        }
                        
                        if (!xmlText || xmlText.length < 100) {
                            throw new Error('ì‘ë‹µì´ ë¹„ì–´ìˆê±°ë‚˜ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤');
                        }
                        
                        // XML íŒŒì‹±
                        const parser = new DOMParser();
                        const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
                        
                        // ì‘ë‹µ ì½”ë“œ í™•ì¸
                        const resultCode = xmlDoc.querySelector('resultCode')?.textContent;
                        const resultMsg = xmlDoc.querySelector('resultMsg')?.textContent;
                        
                        if (resultCode !== '00') {
                            throw new Error(`API Error: ${resultMsg || 'Unknown error'}`);
                        }

                        // ì•„ì´í…œ íŒŒì‹±
                        const items = xmlDoc.querySelectorAll('item');
                        const results = [];

                        items.forEach((item, index) => {
                            const bidData = {
                                id: `${bidType}_${index}_${Date.now()}`,
                                bidType: this.getTypeName(bidType),
                                bidNtceNo: item.querySelector('bidNtceNo')?.textContent || '',
                                bidNtceNm: item.querySelector('bidNtceNm')?.textContent || '',
                                dminsttNm: item.querySelector('dminsttNm')?.textContent || '',
                                bidNtceDt: item.querySelector('bidNtceDt')?.textContent || '',
                                bidClseDt: item.querySelector('bidClseDt')?.textContent || '',
                                presmptPrce: item.querySelector('presmptPrce')?.textContent || '',
                                bidNtceDtlUrl: item.querySelector('bidNtceDtlUrl')?.textContent || '',
                                bidNtceUrl: item.querySelector('bidNtceUrl')?.textContent || '',
                                ntceInsttNm: item.querySelector('ntceInsttNm')?.textContent || ''
                            };
                            results.push(bidData);
                        });

                        console.log(`âœ… ${bidType} ì„±ê³µ: ${results.length}ê°œ ì¡°íšŒë¨`);
                        return results;

                    } catch (error) {
                        console.warn(`${bidType} í”„ë¡ì‹œ ${i+1} ì‹¤íŒ¨:`, error.message);
                        
                        // ë§ˆì§€ë§‰ í”„ë¡ì‹œë„ ì‹¤íŒ¨í•œ ê²½ìš°
                        if (i === this.proxyUrls.length - 1) {
                            console.error(`${bidType} ëª¨ë“  í”„ë¡ì‹œ ì‹¤íŒ¨, ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš©`);
                            return this.getSampleData(bidType);
                        }
                    }
                }
                
                return [];
            }

            getSampleData(bidType) {
                const sampleData = {
                    servc: [
                        {
                            id: `${bidType}_sample_1`,
                            bidType: 'ìš©ì—­',
                            bidNtceNo: 'R25BK01028343',
                            bidNtceNm: 'í¬ë§ë¦¬í„´íŒ¨í‚¤ì§€ ì¬ê¸°ì‚¬ì—…í™” ììœ¨í”„ë¡œê·¸ë¨ í–‰ì‚¬ ëŒ€í–‰ ìš©ì—­',
                            dminsttNm: '(ì‚¬ë‹¨)í•œêµ­ì„œë¹„ìŠ¤í‘œì¤€ì§„í¥ì›',
                            bidNtceDt: '2025-08-26 21:56:00',
                            bidClseDt: '2025-09-05 17:00:00',
                            presmptPrce: '2000000',
                            bidNtceDtlUrl: 'https://www.g2b.go.kr/link/PNPE027_01/single/?bidPbancNo=R25BK01028343&bidPbancOrd=000',
                            bidNtceUrl: 'http://www.g2b.go.kr',
                            ntceInsttNm: '(ì‚¬ë‹¨)í•œêµ­ì„œë¹„ìŠ¤í‘œì¤€ì§„í¥ì›'
                        },
                        {
                            id: `${bidType}_sample_2`,
                            bidType: 'ìš©ì—­',
                            bidNtceNo: 'R25BK01019615',
                            bidNtceNm: 'êµ­ë¦½ì¤‘ì•™ì˜ë£Œì› í˜„ëŒ€í™”ì‚¬ì—… í† ì§€ë³´ìƒ ë° ìˆ˜ìš© ì§€ì›ìš©ì—­',
                            dminsttNm: 'ë³´ê±´ë³µì§€ë¶€',
                            bidNtceDt: '2025-08-26 21:33:00',
                            bidClseDt: '2025-09-02 10:00:00',
                            presmptPrce: '76000000',
                            bidNtceDtlUrl: 'https://www.g2b.go.kr/link/PNPE027_01/single/?bidPbancNo=R25BK01019615&bidPbancOrd=000',
                            bidNtceUrl: 'http://www.g2b.go.kr',
                            ntceInsttNm: 'ë³´ê±´ë³µì§€ë¶€'
                        }
                    ],
                    cnstwk: [
                        {
                            id: `${bidType}_sample_1`,
                            bidType: 'ê±´ì„¤ê³µì‚¬',
                            bidNtceNo: 'C25BK00987654',
                            bidNtceNm: 'â—‹â—‹ì‹œ ë„ì‹œì¬ìƒ ì¸í”„ë¼ êµ¬ì¶• ê³µì‚¬',
                            dminsttNm: 'êµ­í† êµí†µë¶€',
                            bidNtceDt: '2025-08-27 09:00:00',
                            bidClseDt: '2025-09-10 17:00:00',
                            presmptPrce: '5200000000',
                            bidNtceDtlUrl: 'https://www.g2b.go.kr/link/PNPE027_01/single/?bidPbancNo=C25BK00987654&bidPbancOrd=000',
                            bidNtceUrl: 'http://www.g2b.go.kr',
                            ntceInsttNm: 'êµ­í† êµí†µë¶€'
                        }
                    ],
                    thng: [
                        {
                            id: `${bidType}_sample_1`,
                            bidType: 'ë¬¼í’ˆ',
                            bidNtceNo: 'T25BK00123456',
                            bidNtceNm: 'ê³µê³µê¸°ê´€ ë””ì§€í„¸ êµìœ¡ ì¥ë¹„ êµ¬ë§¤',
                            dminsttNm: 'êµìœ¡ë¶€',
                            bidNtceDt: '2025-08-28 14:30:00',
                            bidClseDt: '2025-09-08 18:00:00',
                            presmptPrce: '180000000',
                            bidNtceDtlUrl: 'https://www.g2b.go.kr/link/PNPE027_01/single/?bidPbancNo=T25BK00123456&bidPbancOrd=000',
                            bidNtceUrl: 'http://www.g2b.go.kr',
                            ntceInsttNm: 'êµìœ¡ë¶€'
                        }
                    ]
                };

                return sampleData[bidType] || [];
            }

            // ë‚˜ë¼ì¥í„° ê³µê³  ìƒì„¸ í˜ì´ì§€ URL ìƒì„±
            generateBidDetailUrl(bidNtceNo, bidType) {
                if (!bidNtceNo) return null;
                
                // ë‚˜ë¼ì¥í„° ì…ì°°ê³µê³  ìƒì„¸ë³´ê¸° URL íŒ¨í„´ (2024ë…„ ê¸°ì¤€ ìµœì‹ )
                // ì‹¤ì œ ë‚˜ë¼ì¥í„°ì—ì„œ ì‚¬ìš©í•˜ëŠ” URL êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•¨
                const baseUrl = 'http://www.g2b.go.kr/pt/menu/selectSubFrame.do';
                
                // ì…ì°°ê³µê³  ìƒì„¸ë³´ê¸° ê³µí†µ í”„ë ˆì„
                const frameParams = 'frameId=FRAME_NOTICE_DETAIL&frameSrc=/pt/menu/bizinfo/notice/selectBizInfoDtl.do';
                
                // ê³µê³ ë²ˆí˜¸ ì²˜ë¦¬ - ì‹¤ì œ ë‚˜ë¼ì¥í„°ì—ì„œëŠ” bid_no íŒŒë¼ë¯¸í„° ì‚¬ìš©
                const bidNoParam = encodeURIComponent(bidNtceNo);
                
                return `${baseUrl}?${frameParams}&bid_no=${bidNoParam}&bid_kind=${this.getBidKindCode(bidType)}`;
            }

            // ì…ì°° êµ¬ë¶„ ì½”ë“œ ë°˜í™˜
            getBidKindCode(bidType) {
                const kindMap = {
                    'ìš©ì—­': 'servc',
                    'ê±´ì„¤ê³µì‚¬': 'cnstwk', 
                    'ë¬¼í’ˆ': 'thng'
                };
                return kindMap[bidType] || 'servc';
            }

            // ë‚˜ë¼ì¥í„° í†µí•© ê²€ìƒ‰ URL ìƒì„± (ëŒ€ì•ˆ)
            generateBidSearchUrl(bidNtceNo, bidNtceNm) {
                const searchKeyword = encodeURIComponent(bidNtceNm || bidNtceNo || '');
                return `http://www.g2b.go.kr/pt/menu/selectSubFrame.do?frameId=FRAME_BID_SEARCH&frameSrc=/pt/menu/bizinfo/notice/selectBizInfoList.do&searchKeyword=${searchKeyword}`;
            }

            // ì…ì°°ê³µê³  ë§í¬ HTML ìƒì„±
            generateBidLinkHtml(item) {
                // 1ìˆœìœ„: APIì—ì„œ ì œê³µëœ bidNtceDtlUrl ì‚¬ìš© (ì‹¤ì œ ìƒì„¸ í˜ì´ì§€ URL)
                if (item.bidNtceDtlUrl && item.bidNtceDtlUrl !== '#') {
                    return `<a href="${item.bidNtceDtlUrl}" target="_blank" 
                               class="text-blue-600 hover:text-blue-900 flex items-center transition-colors">
                                <i class="fas fa-external-link-alt mr-1"></i>
                                ìƒì„¸ë³´ê¸°
                            </a>`;
                }

                // 2ìˆœìœ„: APIì—ì„œ ì œê³µëœ bidNtceUrl ì‚¬ìš© (ëŒ€ì•ˆ URL)
                if (item.bidNtceUrl && item.bidNtceUrl !== '#' && !item.bidNtceUrl.includes('sample')) {
                    return `<a href="${item.bidNtceUrl}" target="_blank" 
                               class="text-blue-600 hover:text-blue-900 flex items-center transition-colors">
                                <i class="fas fa-external-link-alt mr-1"></i>
                                ìƒì„¸ë³´ê¸°
                            </a>`;
                }

                // 3ìˆœìœ„: ê³µê³ ë²ˆí˜¸ë¡œ ì§ì ‘ ë§í¬ ìƒì„±
                if (item.bidNtceNo) {
                    const detailUrl = this.generateBidDetailUrl(item.bidNtceNo, item.bidType);
                    return `<a href="${detailUrl}" target="_blank" 
                               class="text-blue-600 hover:text-blue-900 flex items-center transition-colors">
                                <i class="fas fa-external-link-alt mr-1"></i>
                                ìƒì„¸ë³´ê¸°
                            </a>`;
                }

                // 4ìˆœìœ„: ê³µê³ ëª…ìœ¼ë¡œ ê²€ìƒ‰ ë§í¬ ìƒì„±
                if (item.bidNtceNm) {
                    const searchUrl = this.generateBidSearchUrl(item.bidNtceNo, item.bidNtceNm);
                    return `<a href="${searchUrl}" target="_blank" 
                               class="text-orange-600 hover:text-orange-900 flex items-center transition-colors">
                                <i class="fas fa-search mr-1"></i>
                                ê²€ìƒ‰
                            </a>`;
                }

                // 5ìˆœìœ„: ë‚˜ë¼ì¥í„° ë©”ì¸ í˜ì´ì§€
                return `<a href="http://www.g2b.go.kr" target="_blank" 
                           class="text-gray-600 hover:text-gray-900 flex items-center transition-colors">
                            <i class="fas fa-globe mr-1"></i>
                            ë‚˜ë¼ì¥í„°
                        </a>`;
            }

            getTypeName(typeCode) {
                const typeNames = {
                    'servc': 'ìš©ì—­',
                    'cnstwk': 'ê±´ì„¤ê³µì‚¬',
                    'thng': 'ë¬¼í’ˆ'
                };
                return typeNames[typeCode] || typeCode;
            }

            displayResults(data) {
                if (!data || data.length === 0) {
                    this.showEmptyState();
                    return;
                }

                const tbody = document.getElementById('resultsTableBody');
                tbody.innerHTML = '';
                
                data.forEach((item, index) => {
                    const row = this.createTableRow(item, index);
                    tbody.appendChild(row);
                });

                this.updateResultCount(data.length);
                this.showResults();
                this.selectedItems.clear();
                this.updateSelectAllButton();
            }

            createTableRow(item, index) {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 transition-colors duration-200';
                row.dataset.id = item.id;

                // ë‚ ì§œ í¬ë§·íŒ…
                const bidDate = this.formatDisplayDate(item.bidNtceDt);
                const closeDate = this.formatDisplayDate(item.bidClseDt);
                
                // ê°€ê²© í¬ë§·íŒ…
                const price = this.formatPrice(item.presmptPrce);
                
                // ì…ì°° êµ¬ë¶„ ë±ƒì§€ í´ë˜ìŠ¤
                const badgeClass = this.getBadgeClass(item.bidType);

                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <input type="checkbox" class="row-checkbox rounded border-gray-300 text-blue-600 focus:ring-blue-500" 
                               data-id="${item.id}">
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${badgeClass}">
                            ${item.bidType}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${bidDate}
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900 max-w-md truncate" title="${item.bidNtceNm}">
                            ${item.bidNtceNm}
                        </div>
                        <div class="text-sm text-gray-500">ê³µê³ ë²ˆí˜¸: ${item.bidNtceNo}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${item.dminsttNm}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${closeDate}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${price}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                        ${this.generateBidLinkHtml(item)}
                    </td>
                `;

                // ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                const checkbox = row.querySelector('.row-checkbox');
                checkbox.addEventListener('change', (e) => {
                    this.handleRowSelection(e.target.dataset.id, e.target.checked);
                    row.classList.toggle('selected', e.target.checked);
                });

                return row;
            }

            getBadgeClass(bidType) {
                const classes = {
                    'ìš©ì—­': 'badge-servc bg-blue-100 text-blue-800',
                    'ê±´ì„¤ê³µì‚¬': 'badge-cnstwk bg-green-100 text-green-800',
                    'ë¬¼í’ˆ': 'badge-thng bg-yellow-100 text-yellow-800'
                };
                return classes[bidType] || 'bg-gray-100 text-gray-800';
            }

            formatDisplayDate(dateString) {
                if (!dateString) return '-';
                try {
                    const date = new Date(dateString);
                    return date.toLocaleDateString('ko-KR', {
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        hour12: false
                    }).replace(/\./g, '/');
                } catch {
                    return dateString.substring(0, 16);
                }
            }

            formatPrice(priceString) {
                if (!priceString || priceString === 'N/A') return '-';
                try {
                    const price = parseInt(priceString);
                    if (price >= 100000000) {
                        return `${(price / 100000000).toFixed(1)}ì–µì›`;
                    } else if (price >= 10000000) {
                        return `${Math.floor(price / 10000000)}ì²œë§Œì›`;
                    } else {
                        return `${price.toLocaleString()}ì›`;
                    }
                } catch {
                    return priceString;
                }
            }

            handleRowSelection(id, selected) {
                if (selected) {
                    this.selectedItems.add(id);
                } else {
                    this.selectedItems.delete(id);
                }
                this.updateSelectAllButton();
            }

            toggleSelectAll(selectAll) {
                const checkboxes = document.querySelectorAll('.row-checkbox');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = selectAll;
                    const row = checkbox.closest('tr');
                    row.classList.toggle('selected', selectAll);
                    
                    if (selectAll) {
                        this.selectedItems.add(checkbox.dataset.id);
                    } else {
                        this.selectedItems.delete(checkbox.dataset.id);
                    }
                });
                this.updateSelectAllButton();
            }

            selectAll() {
                document.getElementById('headerCheckbox').checked = true;
                this.toggleSelectAll(true);
            }

            updateSelectAllButton() {
                const headerCheckbox = document.getElementById('headerCheckbox');
                const totalRows = document.querySelectorAll('.row-checkbox').length;
                const selectedCount = this.selectedItems.size;
                
                if (selectedCount === 0) {
                    headerCheckbox.checked = false;
                    headerCheckbox.indeterminate = false;
                } else if (selectedCount === totalRows) {
                    headerCheckbox.checked = true;
                    headerCheckbox.indeterminate = false;
                } else {
                    headerCheckbox.checked = false;
                    headerCheckbox.indeterminate = true;
                }
            }

            deleteSelected() {
                if (this.selectedItems.size === 0) {
                    this.showWarningMessage('ì‚­ì œí•  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }

                if (!confirm(`ì„ íƒí•œ ${this.selectedItems.size}ê°œ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    return;
                }

                // ì„ íƒëœ í–‰ë“¤ì„ DOMì—ì„œ ì œê±°
                this.selectedItems.forEach(id => {
                    const row = document.querySelector(`tr[data-id="${id}"]`);
                    if (row) {
                        row.remove();
                    }
                    // allDataì—ì„œë„ ì œê±°
                    this.allData = this.allData.filter(item => item.id !== id);
                });

                this.selectedItems.clear();
                this.updateSelectAllButton();
                this.updateResultCount(this.allData.length);
                this.showSuccessMessage(`ì„ íƒëœ í•­ëª©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }

            exportToExcel() {
                const selectedIds = this.selectedItems.size > 0 ? 
                    Array.from(this.selectedItems) : 
                    this.allData.map(item => item.id);

                if (selectedIds.length === 0) {
                    this.showWarningMessage('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                const exportData = this.allData.filter(bid => selectedIds.includes(bid.id));

                // Excel ë°ì´í„° ì¤€ë¹„
                const excelData = exportData.map(bid => {
                    const price = this.formatPrice(bid.presmptPrce);
                    return {
                        'êµ¬ë¶„': bid.bidType || '',
                        'ê³µê³ ë²ˆí˜¸': bid.bidNtceNo || '',
                        'ê³µê³ ëª…': bid.bidNtceNm || '',
                        'ë°œì£¼ê¸°ê´€': bid.dminsttNm || '',
                        'ê³µê³ ì¼ì‹œ': bid.bidNtceDt || '',
                        'ë§ˆê°ì¼ì‹œ': bid.bidClseDt || '',
                        'ì˜ˆì •ê°€ê²©': price,
                        'ê³µê³ ê¸°ê´€': bid.ntceInsttNm || ''
                    };
                });

                // Excel íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
                const worksheet = XLSX.utils.json_to_sheet(excelData);
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, 'ì…ì°°ê³µê³ ');

                const timestamp = new Date().toISOString().slice(0, 19).replace(/[-:]/g, '').replace('T', '_');
                const filename = `ë‚˜ë¼ì¥í„°_ì…ì°°ê³µê³ _${timestamp}.xlsx`;

                XLSX.writeFile(workbook, filename);
                
                this.showSuccessMessage(`${selectedIds.length}ê°œ í•­ëª©ì´ ì—‘ì…€ íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }

            updateResultCount(count) {
                document.getElementById('resultCount').textContent = `${count}ê±´`;
            }

            showResults() {
                document.getElementById('resultsSection').classList.remove('hidden');
                document.getElementById('emptyState').classList.add('hidden');
            }

            hideResults() {
                document.getElementById('resultsSection').classList.add('hidden');
                document.getElementById('emptyState').classList.add('hidden');
            }

            showEmptyState() {
                document.getElementById('resultsSection').classList.add('hidden');
                document.getElementById('emptyState').classList.remove('hidden');
            }

            showLoading(show, message = 'ê²€ìƒ‰ ì¤‘') {
                const spinner = document.getElementById('loadingSpinner');
                const text = spinner.querySelector('.loading-dots');
                
                if (show) {
                    text.textContent = message;
                    spinner.classList.remove('hidden');
                } else {
                    spinner.classList.add('hidden');
                }
            }

            showSuccessMessage(message) {
                this.showMessage(message, 'success');
            }

            showErrorMessage(message) {
                this.showMessage(message, 'error');
            }

            showWarningMessage(message) {
                this.showMessage(message, 'warning');
            }

            showMessage(message, type = 'info') {
                // ê¸°ì¡´ ë©”ì‹œì§€ ì œê±°
                const existingAlert = document.querySelector('.alert');
                if (existingAlert) {
                    existingAlert.remove();
                }

                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type} fixed top-4 right-4 z-50 max-w-sm shadow-lg`;
                alertDiv.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2"></i>
                        <span>${message}</span>
                        <button class="ml-auto text-current opacity-50 hover:opacity-100" onclick="this.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;

                document.body.appendChild(alertDiv);

                // 3ì´ˆ í›„ ìë™ ì œê±°
                setTimeout(() => {
                    if (alertDiv.parentNode) {
                        alertDiv.remove();
                    }
                }, 3000);
            }
        }

        // ì•± ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            new PublicPortalApp();
        });
    </script>
</body>
</html>